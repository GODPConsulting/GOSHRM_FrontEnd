<div class="content mb10">
  <!-- Page Header -->
  <div class="content-wrapper">
    <div class="page-header">
      <div class="col">
        <h3 class="page-title">Performance Management Preference</h3>
        <ul class="breadcrumb">
          <li class="breadcrumb-item">Performance Management</li>
          <li class="breadcrumb-item active">
            Performance Management Preference
          </li>
        </ul>
      </div>
    </div>

    <!-- Page Content -->
    <div class="page-body">
      <form [formGroup]="appraisalPreferenceForm">
        <div class="row">
          <div class="col-sm-6">
            <div class="form-group">
              <label class="col-form-label"
                >Company<span class="text-danger">*</span></label
              >
              <select
                [disabled]="isDisabled"
                class="form-control"
                [class.invalid]="
                  appraisalPreferenceForm.get('company').invalid &&
                  appraisalPreferenceForm.get('company').touched
                "
                [(ngModel)]="company"
                [ngModelOptions]="{ standalone: true }"
                (change)="getAppraisalCycleByCompanyId($event.target.value)"
              >
                <option selected value="" disabled>Company</option>
                <option
                  *ngFor="let row of offices$ | async"
                  value="{{ row.companyStructureId }}"
                >
                  {{ row.name }}
                </option>
              </select>
              <div
                *ngIf="
                  appraisalPreferenceForm.get('company').invalid &&
                  appraisalPreferenceForm.get('company').touched
                "
              >
                <small
                  *ngIf="
                    appraisalPreferenceForm.get('company').invalid &&
                    appraisalPreferenceForm.get('company').touched
                  "
                  class="text-danger"
                >
                  *Field is required</small
                >
              </div>
            </div>
          </div>

          <div class="col-sm-6">
            <div class="form-group">
              <label class="col-form-label"
                >Current Appraisal Cycle<span class="text-danger"
                  >*</span
                ></label
              >
              <select
                class="form-control"
                [class.invalid]="
                  appraisalPreferenceForm.get('appraisalCircle').invalid &&
                  appraisalPreferenceForm.get('appraisalCircle').touched
                "
                [disabled]="isDisabled"
                [(ngModel)]="appraisalCircle"
                [ngModelOptions]="{ standalone: true }"
                (change)="getAppraisalPreference($event.target.value)"
              >
                <option selected value="">Appraisal Cycle</option>
                <option
                  *ngFor="let row of cycles"
                  value="{{ row.appraisalCycleId }}"
                >
                  {{ row.startPeriod | date }} : {{ row.endPeriod | date }}
                </option>
              </select>
              <div
                *ngIf="
                  appraisalPreferenceForm.get('appraisalCircle').invalid &&
                  appraisalPreferenceForm.get('appraisalCircle').touched
                "
              >
                <small
                  *ngIf="
                    appraisalPreferenceForm.get('appraisalCircle').invalid &&
                    appraisalPreferenceForm.get('appraisalCircle').touched
                  "
                  class="text-danger"
                >
                  *Field is required</small
                >
              </div>
            </div>
          </div>

          <div class="col-sm-6">
            <div class="form-group">
              <label class="text-capitalize"
                >Reviewer 1 comment Visible to reviewee?<span
                  class="text-danger"
                  >*</span
                ></label
              >
              <select
                class="form-control"
                [class.invalid]="
                  appraisalPreferenceForm.get('reviewerOneCommentVisibility')
                    .invalid &&
                  appraisalPreferenceForm.get('reviewerOneCommentVisibility')
                    .touched
                "
                formControlName="reviewerOneCommentVisibility"
              >
                <option value="2">No</option>
                <option value="1">Yes</option>
              </select>
              <div
                *ngIf="
                  appraisalPreferenceForm.get('reviewerOneCommentVisibility')
                    .invalid &&
                  appraisalPreferenceForm.get('reviewerOneCommentVisibility')
                    .touched
                "
              >
                <small
                  *ngIf="
                    appraisalPreferenceForm.get('reviewerOneCommentVisibility')
                      .invalid &&
                    appraisalPreferenceForm.get('reviewerOneCommentVisibility')
                      .touched
                  "
                  class="text-danger"
                >
                  *Field is required</small
                >
              </div>
            </div>
          </div>

          <div class="col-sm-6">
            <div class="form-group">
              <label class="text-capitalize"
                >Reviewer 2 comment Visible to reviewee?<span
                  class="text-danger"
                  >*</span
                ></label
              >
              <select
                class="form-control"
                [class.invalid]="
                  appraisalPreferenceForm.get('reviewerTwoCommentVisibility')
                    .invalid &&
                  appraisalPreferenceForm.get('reviewerTwoCommentVisibility')
                    .touched
                "
                formControlName="reviewerTwoCommentVisibility"
              >
                <option value="2">No</option>
                <option value="1">Yes</option>
              </select>
              <div
                *ngIf="
                  appraisalPreferenceForm.get('reviewerTwoCommentVisibility')
                    .invalid &&
                  appraisalPreferenceForm.get('reviewerTwoCommentVisibility')
                    .touched
                "
              >
                <small
                  *ngIf="
                    appraisalPreferenceForm.get('reviewerTwoCommentVisibility')
                      .invalid &&
                    appraisalPreferenceForm.get('reviewerTwoCommentVisibility')
                      .touched
                  "
                  class="text-danger"
                >
                  *Field is required</small
                >
              </div>
            </div>
          </div>

          <div class="col-sm-6">
            <div class="form-group">
              <label class="text-capitalize"
                >Reviewer 3 comment Visible to reviewee?<span
                  class="text-danger"
                  >*</span
                ></label
              >
              <select
                class="form-control"
                [class.invalid]="
                  appraisalPreferenceForm.get('reviewerThreeCommentVisibility')
                    .invalid &&
                  appraisalPreferenceForm.get('reviewerThreeCommentVisibility')
                    .touched
                "
                formControlName="reviewerThreeCommentVisibility"
              >
                <option value="2">No</option>
                <option value="1">Yes</option>
              </select>
              <div
                *ngIf="
                  appraisalPreferenceForm.get('reviewerThreeCommentVisibility')
                    .invalid &&
                  appraisalPreferenceForm.get('reviewerThreeCommentVisibility')
                    .touched
                "
              >
                <small
                  *ngIf="
                    appraisalPreferenceForm.get(
                      'reviewerThreeCommentVisibility'
                    ).invalid &&
                    appraisalPreferenceForm.get(
                      'reviewerThreeCommentVisibility'
                    ).touched
                  "
                  class="text-danger"
                >
                  *Field is required</small
                >
              </div>
            </div>
          </div>

          <div class="col-sm-6">
            <div class="form-group">
              <label
                >Status of Current Appraisal<span class="text-danger"
                  >*</span
                ></label
              >
              <select
                class="form-control"
                [class.invalid]="
                  appraisalPreferenceForm.get('status').invalid &&
                  appraisalPreferenceForm.get('status').touched
                "
                formControlName="status"
              >
                <option value="1">Open</option>
                <option value="2">Locked</option>
              </select>
              <div
                *ngIf="
                  appraisalPreferenceForm.get('status').invalid &&
                  appraisalPreferenceForm.get('status').touched
                "
              >
                <small
                  *ngIf="
                    appraisalPreferenceForm.get('status').invalid &&
                    appraisalPreferenceForm.get('status').touched
                  "
                  class="text-danger"
                >
                  *Field is required</small
                >
              </div>
            </div>
          </div>

          <div class="col-sm-6">
            <div class="form-group">
              <label
                >Employee can view Coach's Performance Objectives?<span
                  class="text-danger"
                  >*</span
                ></label
              >
              <select
                class="form-control"
                [class.invalid]="
                  appraisalPreferenceForm.get('coachPerformanceVisibility')
                    .invalid &&
                  appraisalPreferenceForm.get('coachPerformanceVisibility')
                    .touched
                "
                formControlName="coachPerformanceVisibility"
              >
                <option value="1">Yes</option>
                <option value="2">No</option>
              </select>
              <div
                *ngIf="
                  appraisalPreferenceForm.get('coachPerformanceVisibility')
                    .invalid &&
                  appraisalPreferenceForm.get('coachPerformanceVisibility')
                    .touched
                "
              >
                <small
                  *ngIf="
                    appraisalPreferenceForm.get('coachPerformanceVisibility')
                      .invalid &&
                    appraisalPreferenceForm.get('coachPerformanceVisibility')
                      .touched
                  "
                  class="text-danger"
                >
                  *Field is required</small
                >
              </div>
            </div>
          </div>
        </div>
        <div class="submit-section">
          <button
            class="btn btn-primary submit-btn"
            type="submit"
            (click)="addAppraisalPreference(appraisalPreferenceForm)"
          >
            <span *ngIf="!spinner">Save & Update</span>
            <span *ngIf="spinner"><i class="fa fa-spinner fa-spin"></i></span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-md-12">
    <div class="table-responsive">
      <p-table
        class="table table-hover"
        [value]="preferences$ | async"
        [scrollable]="true"
        [responsive]="true"
        scrollHeight="flex"
      >
        <ng-template pTemplate="header">
          <tr>
            <th class="">Company</th>
            <th class="text-capitalize">Current Performance mgt cycle</th>
            <th class="text-capitalize">
              reviewer 1 comment visible to reviewee
            </th>
            <th class="text-capitalize">
              reviewer 2 comment visible to reviewee
            </th>
            <th class="text-capitalize">
              reviewer 3 comment visible to reviewee
            </th>
            <th class="text-capitalize">status</th>
            <th class="text-capitalize">
              employee can view coach's performance objectives
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-row let-i="rowIndex">
          <tr (click)="edit(row)" style="cursor: pointer">
            <td>{{ row.companyName }}</td>
            <td>{{ row.appraisalCycleName }}</td>
            <td>{{ row.reviewerOneCommentVisibilityName }}</td>
            <td>{{ row.reviewerTwoCommentVisibilityName }}</td>
            <td>{{ row.reviewerThreeCommentVisibilityName }}</td>
            <td>{{ row.statusName }}</td>
            <td>{{ row.coachPerformanceVisibilityName }}</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>
